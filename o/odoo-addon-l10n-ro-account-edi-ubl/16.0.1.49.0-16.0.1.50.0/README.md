# Comparing `tmp/odoo_addon_l10n_ro_account_edi_ubl-16.0.1.49.0-py3-none-any.whl.zip` & `tmp/odoo_addon_l10n_ro_account_edi_ubl-16.0.1.50.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,64 +1,66 @@
-Zip file size: 122288 bytes, number of entries: 62
--rw-r--r--  2.0 unx     4272 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/README.rst
--rw-r--r--  2.0 unx      173 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/__init__.py
--rw-r--r--  2.0 unx     1014 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/__manifest__.py
--rw-r--r--  2.0 unx      818 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/init_hook.py
--rw-r--r--  2.0 unx     1344 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/data/account_edi_data.xml
--rw-r--r--  2.0 unx      381 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/data/ubl_templates.xml
--rw-r--r--  2.0 unx    17993 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/i18n/l10n_ro_account_edi_ubl.pot
--rw-r--r--  2.0 unx    20411 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/i18n/ro.po
--rw-r--r--  2.0 unx      567 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/migrations/16.0.1.40.1/post-migration.py
--rw-r--r--  2.0 unx      836 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/migrations/16.0.1.43.1/post-migration.py
--rw-r--r--  2.0 unx      284 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/models/__init__.py
--rw-r--r--  2.0 unx    15493 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/models/account_edi_format.py
--rw-r--r--  2.0 unx    19525 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/models/account_edi_xml_cius_ro.py
--rw-r--r--  2.0 unx    12810 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/models/account_move.py
--rw-r--r--  2.0 unx     4002 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/models/ir_actions_report.py
--rw-r--r--  2.0 unx     2242 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/models/l10n_ro_account_anaf_sync_scope.py
--rw-r--r--  2.0 unx     2552 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/models/product.py
--rw-r--r--  2.0 unx     6630 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/models/res_company.py
--rw-r--r--  2.0 unx     1828 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/models/res_config_settings.py
--rw-r--r--  2.0 unx      537 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/models/res_partner.py
--rw-r--r--  2.0 unx      680 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/readme/CONFIGURE.rst
--rw-r--r--  2.0 unx      253 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx       84 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      197 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/security/ir.model.access.csv
--rw-r--r--  2.0 unx    10307 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/static/description/anaf.png
--rw-r--r--  2.0 unx     3036 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/static/description/anaf.svg
--rw-r--r--  2.0 unx     9004 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/static/description/icon.png
--rw-r--r--  2.0 unx    28849 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/static/description/icon.svg
--rw-r--r--  2.0 unx    14068 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/static/description/index.html
--rw-r--r--  2.0 unx     4644 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/5004552043.zip
--rw-r--r--  2.0 unx     4284 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/5004879752.zip
--rw-r--r--  2.0 unx      151 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/__init__.py
--rw-r--r--  2.0 unx     9573 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/common_data_setup.py
--rw-r--r--  2.0 unx     7131 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/credit_note.xml
--rw-r--r--  2.0 unx     7131 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/credit_note_in.xml
--rw-r--r--  2.0 unx     7142 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/credit_note_in_option.xml
--rw-r--r--  2.0 unx     7142 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/credit_note_option.xml
--rw-r--r--  2.0 unx     7148 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/invoice.xml
--rw-r--r--  2.0 unx     4668 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/invoice.zip
--rw-r--r--  2.0 unx     7148 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/invoice_in.xml
--rw-r--r--  2.0 unx      213 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_drept_id_incarcare.xml
--rw-r--r--  2.0 unx      193 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_factura_inexistenta.xml
--rw-r--r--  2.0 unx      142 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_in_prelucrare.xml
--rw-r--r--  2.0 unx      209 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_index_invalid.xml
--rw-r--r--  2.0 unx      213 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_limita_apeluri.xml
--rw-r--r--  2.0 unx      205 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_lipsa_drepturi.xml
--rw-r--r--  2.0 unx      164 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_not_ok.xml
--rw-r--r--  2.0 unx      164 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_ok.xml
--rw-r--r--  2.0 unx      169 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_xml_erori.xml
--rw-r--r--  2.0 unx    11544 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/test_cius_ro_auto_workflow.py
--rw-r--r--  2.0 unx     4294 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/test_cius_ro_required.py
--rw-r--r--  2.0 unx     4380 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/test_cius_ro_xml_generation.py
--rw-r--r--  2.0 unx      294 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/upload_standard_invalid.xml
--rw-r--r--  2.0 unx      201 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/tests/upload_success.xml
--rw-r--r--  2.0 unx     2538 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/views/account_invoice.xml
--rw-r--r--  2.0 unx     4508 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/views/cius_template.xml
--rw-r--r--  2.0 unx      688 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/views/product_view.xml
--rw-r--r--  2.0 unx     7178 b- defN 24-May-24 08:40 odoo/addons/l10n_ro_account_edi_ubl/views/res_config_settings_views.xml
--rw-r--r--  2.0 unx     4957 b- defN 24-May-24 08:40 odoo_addon_l10n_ro_account_edi_ubl-16.0.1.49.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-May-24 08:40 odoo_addon_l10n_ro_account_edi_ubl-16.0.1.49.0.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 24-May-24 08:40 odoo_addon_l10n_ro_account_edi_ubl-16.0.1.49.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     7321 b- defN 24-May-24 08:40 odoo_addon_l10n_ro_account_edi_ubl-16.0.1.49.0.dist-info/RECORD
-62 files, 296024 bytes uncompressed, 109830 bytes compressed:  62.9%
+Zip file size: 125930 bytes, number of entries: 64
+-rw-r--r--  2.0 unx     4272 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/README.rst
+-rw-r--r--  2.0 unx      173 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/__init__.py
+-rw-r--r--  2.0 unx     1014 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/__manifest__.py
+-rw-r--r--  2.0 unx      818 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/init_hook.py
+-rw-r--r--  2.0 unx     1344 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/data/account_edi_data.xml
+-rw-r--r--  2.0 unx      381 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/data/ubl_templates.xml
+-rw-r--r--  2.0 unx    18349 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/i18n/l10n_ro_account_edi_ubl.pot
+-rw-r--r--  2.0 unx    20411 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/i18n/ro.po
+-rw-r--r--  2.0 unx      567 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/migrations/16.0.1.40.1/post-migration.py
+-rw-r--r--  2.0 unx      836 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/migrations/16.0.1.43.1/post-migration.py
+-rw-r--r--  2.0 unx      284 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/models/__init__.py
+-rw-r--r--  2.0 unx    15619 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/models/account_edi_format.py
+-rw-r--r--  2.0 unx    19525 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/models/account_edi_xml_cius_ro.py
+-rw-r--r--  2.0 unx    14839 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/models/account_move.py
+-rw-r--r--  2.0 unx     4002 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/models/ir_actions_report.py
+-rw-r--r--  2.0 unx     2242 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/models/l10n_ro_account_anaf_sync_scope.py
+-rw-r--r--  2.0 unx     2552 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/models/product.py
+-rw-r--r--  2.0 unx     6630 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/models/res_company.py
+-rw-r--r--  2.0 unx     1828 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/models/res_config_settings.py
+-rw-r--r--  2.0 unx      537 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/models/res_partner.py
+-rw-r--r--  2.0 unx      680 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/readme/CONFIGURE.rst
+-rw-r--r--  2.0 unx      253 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx       84 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      197 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/security/ir.model.access.csv
+-rw-r--r--  2.0 unx    10307 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/static/description/anaf.png
+-rw-r--r--  2.0 unx     3036 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/static/description/anaf.svg
+-rw-r--r--  2.0 unx     9004 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/static/description/icon.png
+-rw-r--r--  2.0 unx    28849 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/static/description/icon.svg
+-rw-r--r--  2.0 unx    14068 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/static/description/index.html
+-rw-r--r--  2.0 unx     2352 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/3828.zip
+-rw-r--r--  2.0 unx     4644 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/5004552043.zip
+-rw-r--r--  2.0 unx     4284 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/5004879752.zip
+-rw-r--r--  2.0 unx      151 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/__init__.py
+-rw-r--r--  2.0 unx     9912 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/common_data_setup.py
+-rw-r--r--  2.0 unx     7131 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/credit_note.xml
+-rw-r--r--  2.0 unx     7131 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/credit_note_in.xml
+-rw-r--r--  2.0 unx     7142 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/credit_note_in_option.xml
+-rw-r--r--  2.0 unx     7142 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/credit_note_option.xml
+-rw-r--r--  2.0 unx     7148 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/invoice.xml
+-rw-r--r--  2.0 unx     4668 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/invoice.zip
+-rw-r--r--  2.0 unx     7148 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/invoice_in.xml
+-rw-r--r--  2.0 unx      213 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_drept_id_incarcare.xml
+-rw-r--r--  2.0 unx      193 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_factura_inexistenta.xml
+-rw-r--r--  2.0 unx      142 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_in_prelucrare.xml
+-rw-r--r--  2.0 unx      209 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_index_invalid.xml
+-rw-r--r--  2.0 unx      213 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_limita_apeluri.xml
+-rw-r--r--  2.0 unx      205 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_lipsa_drepturi.xml
+-rw-r--r--  2.0 unx      164 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_not_ok.xml
+-rw-r--r--  2.0 unx      340 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_not_ok_anaf_error.xml
+-rw-r--r--  2.0 unx      164 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_ok.xml
+-rw-r--r--  2.0 unx      169 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_xml_erori.xml
+-rw-r--r--  2.0 unx    12561 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/test_cius_ro_auto_workflow.py
+-rw-r--r--  2.0 unx     4294 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/test_cius_ro_required.py
+-rw-r--r--  2.0 unx     4380 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/test_cius_ro_xml_generation.py
+-rw-r--r--  2.0 unx      294 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/upload_standard_invalid.xml
+-rw-r--r--  2.0 unx      201 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/tests/upload_success.xml
+-rw-r--r--  2.0 unx     2448 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/views/account_invoice.xml
+-rw-r--r--  2.0 unx     4508 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/views/cius_template.xml
+-rw-r--r--  2.0 unx      688 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/views/product_view.xml
+-rw-r--r--  2.0 unx     7178 b- defN 24-May-24 09:27 odoo/addons/l10n_ro_account_edi_ubl/views/res_config_settings_views.xml
+-rw-r--r--  2.0 unx     4957 b- defN 24-May-24 09:27 odoo_addon_l10n_ro_account_edi_ubl-16.0.1.50.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-May-24 09:27 odoo_addon_l10n_ro_account_edi_ubl-16.0.1.50.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 24-May-24 09:27 odoo_addon_l10n_ro_account_edi_ubl-16.0.1.50.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     7559 b- defN 24-May-24 09:27 odoo_addon_l10n_ro_account_edi_ubl-16.0.1.50.0.dist-info/RECORD
+64 files, 302731 bytes uncompressed, 113070 bytes compressed:  62.7%
```

## zipnote {}

```diff
@@ -81,14 +81,17 @@
 
 Filename: odoo/addons/l10n_ro_account_edi_ubl/static/description/icon.svg
 Comment: 
 
 Filename: odoo/addons/l10n_ro_account_edi_ubl/static/description/index.html
 Comment: 
 
+Filename: odoo/addons/l10n_ro_account_edi_ubl/tests/3828.zip
+Comment: 
+
 Filename: odoo/addons/l10n_ro_account_edi_ubl/tests/5004552043.zip
 Comment: 
 
 Filename: odoo/addons/l10n_ro_account_edi_ubl/tests/5004879752.zip
 Comment: 
 
 Filename: odoo/addons/l10n_ro_account_edi_ubl/tests/__init__.py
@@ -135,14 +138,17 @@
 
 Filename: odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_lipsa_drepturi.xml
 Comment: 
 
 Filename: odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_not_ok.xml
 Comment: 
 
+Filename: odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_not_ok_anaf_error.xml
+Comment: 
+
 Filename: odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_ok.xml
 Comment: 
 
 Filename: odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_xml_erori.xml
 Comment: 
 
 Filename: odoo/addons/l10n_ro_account_edi_ubl/tests/test_cius_ro_auto_workflow.py
@@ -168,20 +174,20 @@
 
 Filename: odoo/addons/l10n_ro_account_edi_ubl/views/product_view.xml
 Comment: 
 
 Filename: odoo/addons/l10n_ro_account_edi_ubl/views/res_config_settings_views.xml
 Comment: 
 
-Filename: odoo_addon_l10n_ro_account_edi_ubl-16.0.1.49.0.dist-info/METADATA
+Filename: odoo_addon_l10n_ro_account_edi_ubl-16.0.1.50.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo_addon_l10n_ro_account_edi_ubl-16.0.1.49.0.dist-info/WHEEL
+Filename: odoo_addon_l10n_ro_account_edi_ubl-16.0.1.50.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo_addon_l10n_ro_account_edi_ubl-16.0.1.49.0.dist-info/top_level.txt
+Filename: odoo_addon_l10n_ro_account_edi_ubl-16.0.1.50.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo_addon_l10n_ro_account_edi_ubl-16.0.1.49.0.dist-info/RECORD
+Filename: odoo_addon_l10n_ro_account_edi_ubl-16.0.1.50.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/l10n_ro_account_edi_ubl/README.rst

```diff
@@ -3,15 +3,15 @@
 ==================================
 
 .. 
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    !! This file is generated by oca-gen-addon-readme !!
    !! changes will be overwritten.                   !!
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-   !! source digest: sha256:d364e1f1c5e741cf8941503d695e3d72dc1cfd3f2d93bd43110afb5e340a9186
+   !! source digest: sha256:a39d1312a5e2bbae5d9c0ca0b6703a00ad36ff0a46550b80b16ef7aac8941fba
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 
 .. |badge1| image:: https://img.shields.io/badge/maturity-Mature-brightgreen.png
     :target: https://odoo-community.org/page/development-status
     :alt: Mature
 .. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
     :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
```

## odoo/addons/l10n_ro_account_edi_ubl/__manifest__.py

```diff
@@ -15,15 +15,15 @@
         "data/ubl_templates.xml",
         "views/res_config_settings_views.xml",
         "views/account_invoice.xml",
         "views/product_view.xml",
         "views/cius_template.xml",
     ],
     "license": "AGPL-3",
-    "version": "16.0.1.49.0",
+    "version": "16.0.1.50.0",
     "author": "Terrabit," "NextERP Romania," "Odoo Community Association (OCA)",
     "website": "https://github.com/OCA/l10n-romania",
     "installable": True,
     "development_status": "Mature",
     "pre_init_hook": "pre_init_hook",
     "maintainers": ["dhongu", "feketemihai"],
 }
```

## odoo/addons/l10n_ro_account_edi_ubl/i18n/l10n_ro_account_edi_ubl.pot

```diff
@@ -13,15 +13,14 @@
 "Content-Transfer-Encoding: \n"
 "Plural-Forms: \n"
 
 #. module: l10n_ro_account_edi_ubl
 #. odoo-python
 #: code:addons/l10n_ro_account_edi_ubl/models/account_edi_format.py:0
 #: code:addons/l10n_ro_account_edi_ubl/models/account_edi_format.py:0
-#: code:addons/l10n_ro_account_edi_ubl/models/account_edi_format.py:0
 #: code:addons/l10n_ro_account_edi_ubl/models/account_move.py:0
 #, python-format
 msgid ""
 "\n"
 "\n"
 "Error:\n"
 "<p>%s</p>"
@@ -328,14 +327,21 @@
 #: model:ir.model.fields,field_description:l10n_ro_account_edi_ubl.field_account_bank_statement_line__l10n_ro_show_anaf_download_edi_buton
 #: model:ir.model.fields,field_description:l10n_ro_account_edi_ubl.field_account_move__l10n_ro_show_anaf_download_edi_buton
 #: model:ir.model.fields,field_description:l10n_ro_account_edi_ubl.field_account_payment__l10n_ro_show_anaf_download_edi_buton
 msgid "Show ANAF Download EDI Button"
 msgstr ""
 
 #. module: l10n_ro_account_edi_ubl
+#: model:ir.model.fields,field_description:l10n_ro_account_edi_ubl.field_account_bank_statement_line__l10n_ro_show_edi_fields
+#: model:ir.model.fields,field_description:l10n_ro_account_edi_ubl.field_account_move__l10n_ro_show_edi_fields
+#: model:ir.model.fields,field_description:l10n_ro_account_edi_ubl.field_account_payment__l10n_ro_show_edi_fields
+msgid "Show ANAF EDI Fields"
+msgstr ""
+
+#. module: l10n_ro_account_edi_ubl
 #: model_terms:ir.ui.view,arch_db:l10n_ro_account_edi_ubl.res_config_settings_view_form
 msgid ""
 "Start date that Odoo will create supplier invoices downloaded from ANAF "
 "website."
 msgstr ""
 
 #. module: l10n_ro_account_edi_ubl
```

## odoo/addons/l10n_ro_account_edi_ubl/models/account_edi_format.py

```diff
@@ -2,15 +2,15 @@
 # Copyright (C) 2022 NextERP Romania
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html).
 
 import logging
 
 from lxml import etree
 
-from odoo import _, fields, models
+from odoo import _, api, fields, models
 
 _logger = logging.getLogger(__name__)
 
 
 class AccountEdiXmlCIUSRO(models.Model):
     _inherit = "account.edi.format"
 
@@ -114,14 +114,37 @@
             is_required = (
                 invoice.move_type in ("in_invoice", "in_refund")
                 and invoice.journal_id.l10n_ro_sequence_type == "autoinv2"
                 and bool(invoice.journal_id.l10n_ro_partner_id)
             )
         return is_required
 
+    @api.model
+    def l10n_ro_edi_post_message(self, invoice, message, res):
+        invoice.message_post(body=res["error"])
+        body = message + _("\n\nError:\n<p>%s</p>") % res["error"]
+
+        mail_activity = invoice.activity_ids.filtered(
+            lambda a: a.summary == message and a.user_id == invoice.invoice_user_id
+        )
+        if mail_activity:
+            mail_activity.write(
+                {
+                    "date_deadline": fields.Date.today(),
+                    "note": body,
+                }
+            )
+        else:
+            invoice.activity_schedule(
+                "mail.mail_activity_data_warning",
+                summary=message,
+                note=body,
+                user_id=invoice.invoice_user_id.id,
+            )
+
     def _post_invoice_edi(self, invoices):
         self.ensure_one()
         if self.code != "cius_ro":
             return super()._post_invoice_edi(invoices)
         res = {}
         to_remove_invoices = self.env["account.move"]
         for invoice in invoices:
@@ -139,34 +162,16 @@
             # In case of error, the attachment is a list of string
             if not isinstance(attachment, models.Model):
                 res[invoice] = {
                     "success": False,
                     "error": attachment,
                     "blocking_level": "warning",
                 }
-                invoice.message_post(body=res[invoice]["error"])
                 message = _("There are some errors when generating the XMl file.")
-                body = message + _("\n\nError:\n<p>%s</p>") % res[invoice]["error"]
-
-                model_id = self.env["ir.model"]._get(invoice._name).id
-                domain = [
-                    ("res_model_id", "=", model_id),
-                    ("res_id", "=", invoice.id),
-                    ("summary", "=", body),
-                ]
-                mail_activity = self.env["mail.activity"].search(domain)
-                if mail_activity:
-                    mail_activity.write({"date_deadline": fields.Date.today()})
-                else:
-                    invoice.activity_schedule(
-                        "mail.mail_activity_data_warning",
-                        summary=message,
-                        note=body,
-                        user_id=invoice.invoice_user_id.id,
-                    )
+                self.l10n_ro_edi_post_message(invoice, message, res[invoice])
                 continue
             res[invoice] = {"attachment": attachment, "success": True}
 
             residence = invoice.company_id.l10n_ro_edi_residence or 0
             days = (fields.Date.today() - invoice.invoice_date).days
             if not invoice.l10n_ro_edi_transaction:
                 should_send = days >= residence or self.env.context.get(
@@ -190,21 +195,15 @@
             else:
                 res[invoice] = self._l10n_ro_post_invoice_step_2(invoice, attachment)
             if res[invoice].get("error", False):
                 invoice.message_post(body=res[invoice]["error"])
                 # Create activity if process is stopped with an error blocking level
                 if res[invoice].get("blocking_level") == "error":
                     message = _("The invoice was not send or validated by ANAF.")
-                    body = message + _("\n\nError:\n<p>%s</p>") % res[invoice]["error"]
-                    invoice.activity_schedule(
-                        "mail.mail_activity_data_warning",
-                        summary=message,
-                        note=body,
-                        user_id=invoice.invoice_user_id.id,
-                    )
+                    self.l10n_ro_edi_post_message(invoice, message, res[invoice])
             # If you have ANAF sync configured, but you don't have a transaction
             # number, then the invoice is marked as not sent to ANAF
             if (
                 anaf_config
                 and not invoice.l10n_ro_edi_transaction
                 and not res.get("transaction")
             ):
@@ -275,14 +274,17 @@
 
     def _l10n_ro_post_invoice_step_2(self, invoice, attachment):
         anaf_config = invoice.company_id._l10n_ro_get_anaf_sync(scope="e-factura")
         params = {"id_incarcare": invoice.l10n_ro_edi_transaction}
         res = self._l10n_ro_anaf_call("/stareMesaj", anaf_config, params, method="GET")
         if res.get("id_descarcare", False):
             invoice.write({"l10n_ro_edi_download": res.get("id_descarcare")})
+            error = invoice.l10n_ro_download_zip_anaf(return_error=True)
+            if error:
+                res.update({"error": error, "blocking_level": "error"})
             if res.get("success", False):
                 res.update({"attachment": attachment})
                 invoice.message_post(body=_("The invoice was validated by ANAF."))
                 if invoice.company_id.l10n_ro_store_einvoices:
                     invoice.l10n_ro_download_zip_anaf()
         return res
 
@@ -340,28 +342,33 @@
                 "success": False,
                 "blocking_level": "info",
                 "in_processing": True,
                 "error": _("The invoice is in processing at ANAF."),
             },
             "nok": {
                 "success": False,
-                "blocking_level": "warning",
+                "blocking_level": "error",
                 "error": _("The invoice was not validated by ANAF."),
+                "id_descarcare": doc.get("id_descarcare") or "",
             },
             "ok": {"success": True, "id_descarcare": doc.get("id_descarcare") or ""},
             "XML cu erori nepreluat de sistem": {
                 "success": False,
                 "blocking_level": "error",
                 "error": _("XML with errors not taken over by the system."),
             },
         }
         if stare:
             for key, value in stari.items():
                 if key in stare:
                     res.update(value)
+                    if stare == "nok":
+                        error = doc.get("mesaj_eroare", False)
+                        if error:
+                            res.update({"error": error})
                     break
         return res
 
     def _infer_xml_builder_from_tree(self, tree):
         self.ensure_one()
         customization_id = tree.find("{*}CustomizationID")
         if customization_id is not None:
```

## odoo/addons/l10n_ro_account_edi_ubl/models/account_move.py

```diff
@@ -1,17 +1,20 @@
 # Copyright (C) 2022 Dorin Hongu <dhongu(@)gmail(.)com
 # Copyright (C) 2022 NextERP Romania
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html).
 
 import io
+import logging
 import zipfile
 
 from odoo import _, api, fields, models
 from odoo.exceptions import UserError, ValidationError
 
+_logger = logging.getLogger(__name__)
+
 
 class AccountMove(models.Model):
     _inherit = "account.move"
 
     l10n_ro_edi_transaction = fields.Char(
         "Transaction ID (RO)",
         help="Technical field used to track the status of a submission.",
@@ -19,21 +22,55 @@
     )
     l10n_ro_edi_download = fields.Char(
         "ID Download ANAF (RO)",
         help="ID used to download the ZIP file from ANAF.",
         copy=False,
     )
 
+    l10n_ro_show_edi_fields = fields.Boolean(
+        compute="_compute_l10n_ro_show_edi_fields",
+        string="Show ANAF EDI Fields",
+    )
+
     l10n_ro_show_anaf_download_edi_buton = fields.Boolean(
         compute="_compute_l10n_ro_show_anaf_download_edi_buton",
         string="Show ANAF Download EDI Button",
     )
 
+    @api.depends("edi_state", "move_type")
+    def _compute_l10n_ro_show_edi_fields(self):
+        cius_ro = self.env.ref("l10n_ro_account_edi_ubl.edi_ubl_cius_ro")
+        for invoice in self:
+            show_button = False
+            if (
+                cius_ro._is_required_for_invoice(invoice)
+                and invoice.edi_state == "sent"
+            ):
+                show_button = True
+            elif invoice.move_type in ("in_invoice", "in_refund"):
+                show_button = True
+            invoice.l10n_ro_show_edi_fields = show_button
+
+    @api.depends("l10n_ro_edi_download", "edi_state", "move_type")
+    def _compute_l10n_ro_show_anaf_download_edi_buton(self):
+        cius_ro = self.env.ref("l10n_ro_account_edi_ubl.edi_ubl_cius_ro")
+        for invoice in self:
+            show_button = False
+            if invoice.l10n_ro_edi_download:
+                if (
+                    cius_ro._is_required_for_invoice(invoice)
+                    and invoice.edi_state == "sent"
+                ):
+                    show_button = True
+                elif invoice.move_type in ("in_invoice", "in_refund"):
+                    show_button = True
+            invoice.l10n_ro_show_anaf_download_edi_buton = show_button
+
     @api.constrains("l10n_ro_edi_download")
-    def _check_unique_sequence_number(self):
+    def _check_unique_edi_download_number(self):
         moves = self.filtered(lambda m: m.l10n_ro_edi_download)
         if not moves:
             return
 
         self.flush_model(["l10n_ro_edi_download"])
 
         self._cr.execute(
@@ -58,26 +95,16 @@
                     "ids": ", ".join(str(r[0]) for r in res),
                     "numbers": ", ".join(r[1] for r in res),
                 }
             )
 
     def get_l10n_ro_edi_invoice_needed(self):
         self.ensure_one()
-        is_needed = (
-            self.move_type in ("out_invoice", "out_refund")
-            and self.commercial_partner_id.country_id.code == "RO"
-            and self.commercial_partner_id.is_company
-        )
-        if not is_needed:
-            is_needed = (
-                self.move_type in ("in_invoice", "in_refund")
-                and self.journal_id.l10n_ro_sequence_type == "autoinv2"
-                and self.journal_id.l10n_ro_partner_id
-            )
-        return is_needed
+        cius_ro = self.env.ref("l10n_ro_account_edi_ubl.edi_ubl_cius_ro")
+        return cius_ro._is_required_for_invoice(self)
 
     def button_draft(self):
         # OVERRIDE
         for move in self:
             edi_documents_with_error = move.edi_document_ids.filtered(lambda x: x.error)
             if (
                 move.l10n_ro_edi_transaction
@@ -173,15 +200,15 @@
         high_risk_nc_list = high_risk_nc.split(",")
         return high_risk_nc_list
 
     def _l10n_ro_prepare_invoice_for_download(self):
         self.ensure_one()
         return self
 
-    def l10n_ro_download_zip_anaf(self, anaf_config=False):
+    def l10n_ro_download_zip_anaf(self, anaf_config=False, return_error=False):
         if not anaf_config:
             anaf_config = self.env.company.sudo()._l10n_ro_get_anaf_sync(
                 scope="e-factura"
             )
         if not anaf_config:
             raise UserError(
                 _("The ANAF configuration is not set. Please set it and try again.")
@@ -199,33 +226,65 @@
                 eroare = response.get("eroare", "")
             if status_code == "400":
                 eroare = response.get("message")
             elif status_code == 200 and type(response) == dict:
                 eroare = response.get("eroare")
             cius_ro = self.env.ref("l10n_ro_account_edi_ubl.edi_ubl_cius_ro")
             edi_doc = invoice._get_edi_document(cius_ro)
+            nok_error = False
+            if edi_doc:
+                nok_error = invoice.l10n_ro_check_anaf_error_xml(response)
+            if nok_error:
+                eroare = nok_error
             if eroare:
                 if edi_doc:
                     edi_doc.write({"blocking_level": "warning", "error": eroare})
                 else:
+                    _logger.warning(eroare)
                     raise UserError(eroare)
+            if return_error:
+                return eroare
             else:
                 edi_doc.write({"blocking_level": "info", "error": ""})
                 invoice.l10n_ro_process_anaf_zip_file(response)
         return {
             "type": "ir.actions.client",
             "tag": "display_notification",
             "params": {
                 "title": "Downloaded ZIP file from ANAF",
                 "message": "The file downloaded from ANAF has been attached to the invoice.",
                 "sticky": False,
                 "next": {"type": "ir.actions.act_window_close"},
             },
         }
 
+    def l10n_ro_check_anaf_error_xml(self, zip_content):
+        self.ensure_one()
+        cius_ro = self.env.ref("l10n_ro_account_edi_ubl.edi_ubl_cius_ro")
+        err_msg = False
+        try:
+            zip_ref = zipfile.ZipFile(io.BytesIO(zip_content))
+            err_file = [
+                f
+                for f in zip_ref.namelist()
+                if f"{self.l10n_ro_edi_transaction}.xml" == f
+            ]
+            if err_file:
+                err_cont = zip_ref.read(err_file[0])
+                decode_xml = cius_ro._decode_xml(err_file[0], err_cont)
+                if decode_xml:
+                    tree = decode_xml[0]["xml_tree"]
+                error_tag = "Error"
+                err_msg = "Erori validare ANAF:<br/>"
+                for _index, err in enumerate(tree.findall("./{*}" + error_tag)):
+                    err_msg += f"{err.attrib.get('errorMessage')}<br/>"
+        except Exception as e:
+            _logger.warning(f"Error while checking the Zipped XML file: {e}")
+        return err_msg
+
     def l10n_ro_process_anaf_zip_file(self, zip_content):
         self.ensure_one()
         attachment_zip = self.l10n_ro_save_file(
             "%s.zip" % self.l10n_ro_edi_transaction, zip_content, "application/zip"
         )
         attachment = self.l10n_ro_save_anaf_xml_file(zip_content)
         cius_ro = self.env.ref("l10n_ro_account_edi_ubl.edi_ubl_cius_ro")
@@ -244,32 +303,38 @@
                         "The invoice already have invoice lines, "
                         "you cannot update them again from the XMl downloaded file."
                     )
                 )
 
     def l10n_ro_get_xml_file(self, zip_ref):
         file_name = xml_file = False
-        # if self.get_l10n_ro_edi_invoice_needed():
-        #     xml_file = [f for f in zip_ref.namelist() if "semnatura" in f]
-        # else:
-        #     xml_file = [f for f in zip_ref.namelist() if "semnatura" not in f]
         xml_file = [f for f in zip_ref.namelist() if "semnatura" not in f]
         if xml_file:
             file_name = xml_file[0]
             xml_file = zip_ref.read(file_name)
         return file_name, xml_file
 
     def l10n_ro_save_anaf_xml_file(self, zip_content):
         """Process a ZIP containing the sending and official XML signed
         document. This will only be available for invoices that have
         been successfully validated by ANAF and the government.
         """
         self.ensure_one()
-        zip_ref = zipfile.ZipFile(io.BytesIO(zip_content))
-        file_name, xml_file = self.l10n_ro_get_xml_file(zip_ref)
+        file_name = xml_file = False
+        try:
+            zip_ref = zipfile.ZipFile(io.BytesIO(zip_content))
+            file_name, xml_file = self.l10n_ro_get_xml_file(zip_ref)
+        except Exception as e:
+            # In case the file is not zip, we will try to read it as XML
+            _logger.warning(f"Error while processing the Zipped XML file: {e}")
+            try:
+                xml_file = zip_content
+                file_name = f"{self.l10n_ro_edi_transaction}.xml"
+            except Exception as e:
+                _logger.warning(f"Error while processing the XML file: {e}")
         if not xml_file:
             return self.env["ir.attachment"]
         xml_file = xml_file.replace(
             b'xmlns:schemaLocation="urn:oasis:names:specification:ubl:schema:xsd:Invoice-2 http://docs.oasis-open.org/ubl/os-UBL-2.1/xsd/maindoc/UBL-Invoice-2.1.xsd"',  # noqa: B950
             b'xsi:schemaLocation="urn:oasis:names:specification:ubl:schema:xsd:Invoice-2 ../../UBL-2.1(1)/xsd/maindoc/UBL-Invoice-2.1.xsd"',  # noqa: B950
         )
         attachment = self.l10n_ro_save_file(file_name, xml_file)
@@ -293,30 +358,14 @@
                 "res_model": "account.move",
                 "res_id": self.id,
                 "mimetype": mimetype,
             }
         )
         return attachment
 
-    def _compute_l10n_ro_show_anaf_download_edi_buton(self):
-        for invoice in self:
-            show_button = False
-            if invoice.l10n_ro_edi_download:
-                if (
-                    invoice.move_type in ("out_invoice", "out_refund")
-                    and invoice.edi_state == "sent"
-                ):
-                    show_button = True
-                elif (
-                    invoice.move_type in ("in_invoice", "in_refund")
-                    and not invoice.invoice_line_ids
-                ):
-                    show_button = True
-            invoice.l10n_ro_show_anaf_download_edi_buton = show_button
-
 
 class AccountMoveLine(models.Model):
     _inherit = "account.move.line"
 
     def _get_computed_price_unit(self):
         self.ensure_one()
         if (
```

## odoo/addons/l10n_ro_account_edi_ubl/static/description/index.html

```diff
@@ -362,15 +362,15 @@
 <div class="document" id="romania-efactura-account-edi-ubl">
 <h1 class="title">Romania - eFactura Account EDI UBL</h1>
 
 <!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 !! This file is generated by oca-gen-addon-readme !!
 !! changes will be overwritten.                   !!
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-!! source digest: sha256:d364e1f1c5e741cf8941503d695e3d72dc1cfd3f2d93bd43110afb5e340a9186
+!! source digest: sha256:a39d1312a5e2bbae5d9c0ca0b6703a00ad36ff0a46550b80b16ef7aac8941fba
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
 <p><a class="reference external image-reference" href="https://odoo-community.org/page/development-status"><img alt="Mature" src="https://img.shields.io/badge/maturity-Mature-brightgreen.png" /></a> <a class="reference external image-reference" href="http://www.gnu.org/licenses/agpl-3.0-standalone.html"><img alt="License: AGPL-3" src="https://img.shields.io/badge/licence-AGPL--3-blue.png" /></a> <a class="reference external image-reference" href="https://github.com/OCA/l10n-romania/tree/16.0/l10n_ro_account_edi_ubl"><img alt="OCA/l10n-romania" src="https://img.shields.io/badge/github-OCA%2Fl10n--romania-lightgray.png?logo=github" /></a> <a class="reference external image-reference" href="https://translation.odoo-community.org/projects/l10n-romania-16-0/l10n-romania-16-0-l10n_ro_account_edi_ubl"><img alt="Translate me on Weblate" src="https://img.shields.io/badge/weblate-Translate%20me-F47D42.png" /></a> <a class="reference external image-reference" href="https://runboat.odoo-community.org/builds?repo=OCA/l10n-romania&amp;target_branch=16.0"><img alt="Try me on Runboat" src="https://img.shields.io/badge/runboat-Try%20me-875A7B.png" /></a></p>
 <p>The module will generate E-Invoice XML files according to ANAF E-Invoicing service.</p>
 <p><strong>Table of contents</strong></p>
 <div class="contents local topic" id="contents">
 <ul class="simple">
 <li><a class="reference internal" href="#configuration" id="toc-entry-1">Configuration</a></li>
```

## odoo/addons/l10n_ro_account_edi_ubl/tests/common_data_setup.py

```diff
@@ -234,14 +234,23 @@
 
     # Utility methods
     def get_file(self, filename):
         # Get the content of a test file
         test_file = get_module_resource("l10n_ro_account_edi_ubl", "tests", filename)
         return open(test_file).read().encode("utf-8")
 
+    # Utility methods
+    def get_zip_file(self, filename):
+        # Get the content of a test file
+        bytes_content = b""
+        test_file = get_module_resource("l10n_ro_account_edi_ubl", "tests", filename)
+        with open(test_file, "rb") as file_data:
+            bytes_content = file_data.read()
+        return bytes_content
+
     def check_invoice_documents(
         self, invoice, state="to_send", error=False, blocking_level=False
     ):
         sleep_time = 0
         while not invoice.edi_state and sleep_time < 30:
             time.sleep(1)
             sleep_time += 1
```

## odoo/addons/l10n_ro_account_edi_ubl/tests/test_cius_ro_auto_workflow.py

```diff
@@ -97,32 +97,32 @@
 
     # Test case for the different scenarios of processing documents in step 2
     # of the CIUS workflow.
     def test_process_document_web_services_step2_not_ok(self):
         self.prepare_invoice_sent_step1()
         cases = [
             (
-                self.get_file("stare_mesaj_not_ok.xml"),
-                "to_send",
-                "The invoice was not validated by ANAF.",
-                "warning",
-            ),
-            (
                 self.get_file("stare_mesaj_in_prelucrare.xml"),
                 "to_send",
                 "The invoice is in processing at ANAF.",
                 "info",
             ),
             (
                 self.get_file("stare_mesaj_limita_apeluri.xml"),
                 "to_send",
                 "<p>S-au facut deja 20 descarcari de mesaj in cursul zilei</p>",
                 "warning",
             ),
             (
+                self.get_file("stare_mesaj_not_ok.xml"),
+                "to_send",
+                "The invoice was not validated by ANAF.",
+                "error",
+            ),
+            (
                 self.get_file("stare_mesaj_xml_erori.xml"),
                 "to_send",
                 "XML with errors not taken over by the system",
                 "error",
             ),
             (
                 self.get_file("stare_mesaj_drept_id_incarcare.xml"),
@@ -162,14 +162,38 @@
             self.invoice.with_context(
                 test_data=check_case[0]
             ).action_process_edi_web_services()
             self.check_invoice_documents(
                 self.invoice, check_case[1], check_case[2], check_case[3]
             )
 
+    def test_step2_not_ok_anaf_error(self):
+        self.prepare_invoice_sent_step1()
+        not_ok_content = self.get_file("stare_mesaj_not_ok.xml")
+        anaf_error_zipfile = self.get_zip_file("3828.zip")
+
+        def _l10n_ro_einvoice_call(self, func, params, data=None, method="POST"):
+            if func == "/descarcare":
+                return anaf_error_zipfile, 200
+            else:
+                return not_ok_content, 200
+
+        with patch(
+            "odoo.addons.l10n_ro_account_edi_ubl.models.l10n_ro_account_anaf_sync_scope."
+            "AccountANAFSyncScope._l10n_ro_einvoice_call",
+            _l10n_ro_einvoice_call,
+        ):
+            self.invoice.action_process_edi_web_services()
+            self.check_invoice_documents(
+                self.invoice,
+                "to_send",
+                "<p>Erori validare ANAF:<br>E: validari globale\n eroare regula: R6.1: CIF-ul vanzatorului nu figureaza in baza de date:6443019833<br></p>",  # noqa
+                "error",
+            )
+
     def test_download_invoice(self):
         data = self.invoice_zip
         self.invoice.invoice_line_ids = False
         self.invoice.l10n_ro_edi_download = "1234"
         self.invoice.with_context(test_data=data).l10n_ro_download_zip_anaf()
         with self.assertRaises(UserError):
             self.invoice.with_context(test_data=data).l10n_ro_download_zip_anaf()
```

## odoo/addons/l10n_ro_account_edi_ubl/views/account_invoice.xml

### odoo/addons/l10n_ro_account_edi_ubl/views/account_invoice.xml

```diff
@@ -3,21 +3,22 @@
   <record id="view_move_form" model="ir.ui.view">
     <field name="name">account.move.form</field>
     <field name="model">account.move</field>
     <field name="type">form</field>
     <field name="inherit_id" ref="account.view_move_form"/>
     <field name="arch" type="xml">
       <xpath expr="//div[@name='journal_div']" position="after">
-        <label for="l10n_ro_edi_transaction" string="ID eFactura Transaction" attrs="{'invisible': [('l10n_ro_edi_transaction', '=', False)]}"/>
-        <div name="l10n_ro_edi_transaction" class="d-flex" attrs="{'invisible': [('l10n_ro_edi_transaction', '=', False)]}">
+        <field name="l10n_ro_show_edi_fields" invisible="1"/>
+        <label for="l10n_ro_edi_transaction" string="ID eFactura Transaction" attrs="{'invisible': [('l10n_ro_show_edi_fields', '=', False)]}"/>
+        <div name="l10n_ro_edi_transaction" class="d-flex" attrs="{'invisible': [('l10n_ro_show_edi_fields', '=', False)]}">
           <field name="l10n_ro_edi_transaction" attrs="{'readonly': [('l10n_ro_edi_transaction', '!=', False)]}"/>
         </div>
-        <label for="l10n_ro_edi_download" string="ID eFactura" attrs="{'invisible': ['|', '&amp;',  ('state', '=', 'draft'), ('move_type', 'in', ['out_invoice','out_refund']), ('move_type', '=', 'entry') ]}"/>
-        <div name="l10n_ro_edi_download" attrs="{'invisible': ['|', '&amp;',  ('state', '=', 'draft'), ('move_type', 'in', ['out_invoice','out_refund']), ('move_type', '=', 'entry') ]}" class="o_row">
-          <field name="l10n_ro_edi_download" attrs="{'readonly': ['|', ('move_type', 'in', ['out_invoice','out_refund']), ('state','==','posted')]}"/>
+        <label for="l10n_ro_edi_download" string="ID eFactura" attrs="{'invisible': [('l10n_ro_show_edi_fields', '=', False)]}"/>
+        <div name="l10n_ro_edi_download" attrs="{'invisible': [('l10n_ro_show_edi_fields', '=', False)]}" class="o_row">
+          <field name="l10n_ro_edi_download" attrs="{'readonly': [('l10n_ro_edi_download', '!=', False),('l10n_ro_edi_transaction', '!=', False)]}"/>
           <field name="l10n_ro_show_anaf_download_edi_buton" invisible="1"/>
           <button type="object" class="oe_link badge btn-primary" icon="fa-cloud-download" string="Download from ANAF" name="l10n_ro_download_zip_anaf" attrs="{'invisible': [('l10n_ro_show_anaf_download_edi_buton', '=', False)]}" help="Download ZIP with signed XML file from ANAF"/>
         </div>
       </xpath>
     </field>
   </record>
 </odoo>
```

## Comparing `odoo_addon_l10n_ro_account_edi_ubl-16.0.1.49.0.dist-info/METADATA` & `odoo_addon_l10n_ro_account_edi_ubl-16.0.1.50.0.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo-addon-l10n-ro-account-edi-ubl
-Version: 16.0.1.49.0
+Version: 16.0.1.50.0
 Summary: Romania - eFactura - Account EDI UBL
 Home-page: https://github.com/OCA/l10n-romania
 Author: Terrabit,NextERP Romania,Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
@@ -21,15 +21,15 @@
 ==================================
 
 .. 
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    !! This file is generated by oca-gen-addon-readme !!
    !! changes will be overwritten.                   !!
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-   !! source digest: sha256:d364e1f1c5e741cf8941503d695e3d72dc1cfd3f2d93bd43110afb5e340a9186
+   !! source digest: sha256:a39d1312a5e2bbae5d9c0ca0b6703a00ad36ff0a46550b80b16ef7aac8941fba
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 
 .. |badge1| image:: https://img.shields.io/badge/maturity-Mature-brightgreen.png
     :target: https://odoo-community.org/page/development-status
     :alt: Mature
 .. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
     :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
```

## Comparing `odoo_addon_l10n_ro_account_edi_ubl-16.0.1.49.0.dist-info/RECORD` & `odoo_addon_l10n_ro_account_edi_ubl-16.0.1.50.0.dist-info/RECORD`

 * *Files 7% similar despite different names*

```diff
@@ -1,62 +1,64 @@
-odoo/addons/l10n_ro_account_edi_ubl/README.rst,sha256=Ut_DQzYNNeD-X5jee3gLs5eLFbJcHnj_K-2T_t8bJHg,4272
+odoo/addons/l10n_ro_account_edi_ubl/README.rst,sha256=tsaBmeqsfjl2rtLXcOADEyXxkWZGRq_Xri-OXyBVfZ8,4272
 odoo/addons/l10n_ro_account_edi_ubl/__init__.py,sha256=ntRoTbE9mPme6r2pZcUXoUsJmujQ-yOkeulaLHA-la8,173
-odoo/addons/l10n_ro_account_edi_ubl/__manifest__.py,sha256=dKilFLvXym_8cfY9cUbHe0X9WWgcsTRRO7_fUjVKys0,1014
+odoo/addons/l10n_ro_account_edi_ubl/__manifest__.py,sha256=Eb0pdfko7lCmrvzIt0Bei3LJI6B0d4orOwXcg69zDq4,1014
 odoo/addons/l10n_ro_account_edi_ubl/init_hook.py,sha256=6D2k0MAGsJuOf3QvI3tWPV4oRvstuuz7p8qREpV8DCI,818
 odoo/addons/l10n_ro_account_edi_ubl/data/account_edi_data.xml,sha256=bKCPw6cE5ZDEh3-JOsFyxu4azgAQHPbHvhybq93WUIE,1344
 odoo/addons/l10n_ro_account_edi_ubl/data/ubl_templates.xml,sha256=o01GLc3rL9o07E-UeS4pLw32aYD_F_Zpa1crb5cq_Jo,381
-odoo/addons/l10n_ro_account_edi_ubl/i18n/l10n_ro_account_edi_ubl.pot,sha256=y42PQ5IFbxQesIYTgQ_VtYU8o6VeJsgwRM--P82WtNo,17993
+odoo/addons/l10n_ro_account_edi_ubl/i18n/l10n_ro_account_edi_ubl.pot,sha256=oRccs1WPaAgGjdh3k907YVS2fLmioVA7XW_m0_4ejPs,18349
 odoo/addons/l10n_ro_account_edi_ubl/i18n/ro.po,sha256=Fq_JIF0uF_LY5oaHBAlIoSeWXE570m84EX-gwh0s_-8,20411
 odoo/addons/l10n_ro_account_edi_ubl/migrations/16.0.1.40.1/post-migration.py,sha256=oL66qRyNKVyEh90WQMIs9_cgTpLiz1N_juaiY3oruFw,567
 odoo/addons/l10n_ro_account_edi_ubl/migrations/16.0.1.43.1/post-migration.py,sha256=vuu-6MnNF3_Jca8V2fXB5jy2NQ4xWe00MNGdw4fpFGI,836
 odoo/addons/l10n_ro_account_edi_ubl/models/__init__.py,sha256=4fodGSMhDsUVG-u3_gDS2uyu5qf3gODQLPnXbRBv1xM,284
-odoo/addons/l10n_ro_account_edi_ubl/models/account_edi_format.py,sha256=2uSzjoDHY0XgOlYQsb6uyxtJBgP0fNoFSFeg3WShAow,15493
+odoo/addons/l10n_ro_account_edi_ubl/models/account_edi_format.py,sha256=eCmwfHByeS6FtELg8W9KpUVnS2Jt9MGjzKHrHSpeMrQ,15619
 odoo/addons/l10n_ro_account_edi_ubl/models/account_edi_xml_cius_ro.py,sha256=WALXuQ9Z79w64URr4os8G6IN9HOYMwwgkZw1KSglT-k,19525
-odoo/addons/l10n_ro_account_edi_ubl/models/account_move.py,sha256=CB2F9cZU7PTLDOY1MFf3912rz-3yaAZfN0R3xvHYArg,12810
+odoo/addons/l10n_ro_account_edi_ubl/models/account_move.py,sha256=9sNiqK6tMo7OqKgfFX-iTm-VSXVt3CImff7q8FwfpLM,14839
 odoo/addons/l10n_ro_account_edi_ubl/models/ir_actions_report.py,sha256=J0O1mARMVf1Mz_-_NVcx7Dnf02rQbiKuxSQTA5AxyzU,4002
 odoo/addons/l10n_ro_account_edi_ubl/models/l10n_ro_account_anaf_sync_scope.py,sha256=RASC6QlnSo-DtXkZrgw_QA9bOHej7igl9fzUNUPawFc,2242
 odoo/addons/l10n_ro_account_edi_ubl/models/product.py,sha256=yxwAc5O3NzDNXgtMb9t8uxORAOTV1vlqsVA_9aQ4_yw,2552
 odoo/addons/l10n_ro_account_edi_ubl/models/res_company.py,sha256=AWUGrlkpH1yQ3DOozuVXm7f-E2JDAS-70puoS2huADo,6630
 odoo/addons/l10n_ro_account_edi_ubl/models/res_config_settings.py,sha256=DMLP6lHEuNfDQ3K-DpBq9NbwU_xa_gyHx1YLUQMES_0,1828
 odoo/addons/l10n_ro_account_edi_ubl/models/res_partner.py,sha256=bFp3pAXF0ttTogag3YDn-p5W0KovFGfhLm9C740lB54,537
 odoo/addons/l10n_ro_account_edi_ubl/readme/CONFIGURE.rst,sha256=vCmkYTx8rT-OZEmxRqryi9KPUvMHGFymdOYaFMNrRU8,680
 odoo/addons/l10n_ro_account_edi_ubl/readme/CONTRIBUTORS.rst,sha256=OUaJPhLffnmHrrG9UF86cEl-ql_qAf3ymQ5q2P26ELU,253
 odoo/addons/l10n_ro_account_edi_ubl/readme/DESCRIPTION.rst,sha256=1umSaAxjpavuiFAko1SIddz4CFuFcXHjzwzmrBFXFQA,84
 odoo/addons/l10n_ro_account_edi_ubl/security/ir.model.access.csv,sha256=3UGin3bWEiBTOY1p10j2P8jX51Yq2FMsqc9Wb1URuUI,197
 odoo/addons/l10n_ro_account_edi_ubl/static/description/anaf.png,sha256=QSMAZHVR8qj37v2R4BjZ9j_p1Zr51HUg5LZ7Ta5ma9o,10307
 odoo/addons/l10n_ro_account_edi_ubl/static/description/anaf.svg,sha256=UpMAJNvjsvHdmsy-zAy8ce_f-i5KaL1M978gMF6mCRE,3036
 odoo/addons/l10n_ro_account_edi_ubl/static/description/icon.png,sha256=lx-DWNJafpFP0KWDjYtz6jQ07MqlVs10YMvFiWl8xKM,9004
 odoo/addons/l10n_ro_account_edi_ubl/static/description/icon.svg,sha256=zN6MLeM3mxNJHGTI1kAuvjhxJQlp4lJCgPEAqBvhIyc,28849
-odoo/addons/l10n_ro_account_edi_ubl/static/description/index.html,sha256=TD_mP7ZwMX4iFZ0A8OcYAuLemVxVAb4g-tKRJ7ZE8ts,14068
+odoo/addons/l10n_ro_account_edi_ubl/static/description/index.html,sha256=e5i0kFVrqj0btGSDe8KhHRWEPz_SEl7U-BsT-UJmDqg,14068
+odoo/addons/l10n_ro_account_edi_ubl/tests/3828.zip,sha256=0PQ9Xy-rPW86Ji0oYxXzW0YhQSO2BGLeXb7JfrnXVbU,2352
 odoo/addons/l10n_ro_account_edi_ubl/tests/5004552043.zip,sha256=QDJzP_-bNNAxzytds8gbVAUKbdcGWS6T4i-2RtpMRgY,4644
 odoo/addons/l10n_ro_account_edi_ubl/tests/5004879752.zip,sha256=eJDI-cpeOlbPELlwM5CYbIvJlABTYjL7bsKm7P-dq1w,4284
 odoo/addons/l10n_ro_account_edi_ubl/tests/__init__.py,sha256=CeAU7UHOOUbp97br_dh2mVKBYOpQxIPblgBc3J-8_Bs,151
-odoo/addons/l10n_ro_account_edi_ubl/tests/common_data_setup.py,sha256=KaTCVFNVGE0x50VQCbn_lF42DDV878S8poYO3NUa66s,9573
+odoo/addons/l10n_ro_account_edi_ubl/tests/common_data_setup.py,sha256=CZ9-pKxbx2OkAIxayNusr9NNXbv_WVIIo5QIY8dxc5o,9912
 odoo/addons/l10n_ro_account_edi_ubl/tests/credit_note.xml,sha256=GdjgsCynjubkjTo7e3P7RK2EBpzMw_Gz44-aw6hTEOE,7131
 odoo/addons/l10n_ro_account_edi_ubl/tests/credit_note_in.xml,sha256=BLGWO7Z0Q-cmivbt0QeTxsSQDLUQErLE9eZ-WDONwGQ,7131
 odoo/addons/l10n_ro_account_edi_ubl/tests/credit_note_in_option.xml,sha256=nrKWlvp9vav3L9ExnDT3VfQ9MvFOiEI2beMWHG4TGpU,7142
 odoo/addons/l10n_ro_account_edi_ubl/tests/credit_note_option.xml,sha256=epVj477uFh2H9VFsh03dvPV9cO66UOB9civQeF7Pq_k,7142
 odoo/addons/l10n_ro_account_edi_ubl/tests/invoice.xml,sha256=e_RKA_Yzd0tsu85fQqicp4eWvJ9PBjl4QMPwgwJouUE,7148
 odoo/addons/l10n_ro_account_edi_ubl/tests/invoice.zip,sha256=u34Oz1V3-YZdIIOAynQiZxWSQfu-h6t_TzNZpr_mC8Q,4668
 odoo/addons/l10n_ro_account_edi_ubl/tests/invoice_in.xml,sha256=Dln3lqNHMMlpdY9UqshpEyjq_vqHlzoVZTFIBinOt-c,7148
 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_drept_id_incarcare.xml,sha256=IRNRvOxd1Jh-K7uPPiCegqfbPwP_n2OS3GOAvcV9I7w,213
 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_factura_inexistenta.xml,sha256=xb41Eisj2H--Xsfl-1N9KU-usHUUbw8Wb67sFTdN7tI,193
 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_in_prelucrare.xml,sha256=_pLXvNGCP_ZHMeHc6liZGWQ2TSUjoVT-v2Wjbwu5Ow8,142
 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_index_invalid.xml,sha256=7PSz6e0K0gWDeoZxzgKcqmMfJcuHrSlEAfp5NC2uR7c,209
 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_limita_apeluri.xml,sha256=Sn24cvUCCy9uskmg0zJ6v8GyAkhpuzT6kH5VF0zOJdw,213
 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_lipsa_drepturi.xml,sha256=s0tT4NtjdtudjmVGnIvpuIPWFRvT0DQ6d3oBJ9mQE6I,205
 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_not_ok.xml,sha256=w_HWqAZLvv-Dq4i5slJLWRoGymesfy5gR_tcZu4D8B0,164
+odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_not_ok_anaf_error.xml,sha256=FZHKDyRnahc1H6rddYDQ7aZS8NyKvXhQWiX4MQCoCF0,340
 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_ok.xml,sha256=BmC3WiTAeToFAnpqeTNct1OOc6Gb2V6mpPpMoQr9UuY,164
 odoo/addons/l10n_ro_account_edi_ubl/tests/stare_mesaj_xml_erori.xml,sha256=WxDP4mhQfZ-Xbwzq68wInhtf-wJgBB6b_loFOOgnm0w,169
-odoo/addons/l10n_ro_account_edi_ubl/tests/test_cius_ro_auto_workflow.py,sha256=EkTUi0VnX07WyZ6uCMfkG1FgwTr5nj8HJgOLe68FJBQ,11544
+odoo/addons/l10n_ro_account_edi_ubl/tests/test_cius_ro_auto_workflow.py,sha256=UbqO7IpcZqFGpueL0EYhsU6dstQVfQlCRKGu6CjUYn8,12561
 odoo/addons/l10n_ro_account_edi_ubl/tests/test_cius_ro_required.py,sha256=zc9GSEQCdSfZsTrxyrjY6vE9Sk4O162Qq068U1kzatw,4294
 odoo/addons/l10n_ro_account_edi_ubl/tests/test_cius_ro_xml_generation.py,sha256=7m763h6uy3dAsy67c-bvJWMY4-sUQooVqyYgNjj5C-A,4380
 odoo/addons/l10n_ro_account_edi_ubl/tests/upload_standard_invalid.xml,sha256=-s49mE4Rlgl5MTgkDMMsB_8pMFino_fO98WOqtwdLyM,294
 odoo/addons/l10n_ro_account_edi_ubl/tests/upload_success.xml,sha256=K4I7ZhyLogIbaUoOybPnpV-Mrj-HOAHl2pEkYJg7aYI,201
-odoo/addons/l10n_ro_account_edi_ubl/views/account_invoice.xml,sha256=r5gSsje7tJc0heiv2vJloFKkYQXYyysIjCcQcADGYsI,2538
+odoo/addons/l10n_ro_account_edi_ubl/views/account_invoice.xml,sha256=sDmzpFoym70tt8zDCzY-Vj-mxoEoU2YQsciHq-OGn4Y,2448
 odoo/addons/l10n_ro_account_edi_ubl/views/cius_template.xml,sha256=fwP8P_BHyN2Eap-69mjH3vWTOt27zaE_FPCnRVtdmN4,4508
 odoo/addons/l10n_ro_account_edi_ubl/views/product_view.xml,sha256=P1FPTauN7VaXPqlD4QSI99SP9tVMAhi40cPN-f4hq8I,688
 odoo/addons/l10n_ro_account_edi_ubl/views/res_config_settings_views.xml,sha256=yempnRoiLXENx3Y9Q9dmMlW8-e5PsqcEDAOrN19kQtI,7178
-odoo_addon_l10n_ro_account_edi_ubl-16.0.1.49.0.dist-info/METADATA,sha256=qWjvcedHL11sARmEogLHxfLn4A1n68IAXDhXx8WN5Sw,4957
-odoo_addon_l10n_ro_account_edi_ubl-16.0.1.49.0.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-odoo_addon_l10n_ro_account_edi_ubl-16.0.1.49.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo_addon_l10n_ro_account_edi_ubl-16.0.1.49.0.dist-info/RECORD,,
+odoo_addon_l10n_ro_account_edi_ubl-16.0.1.50.0.dist-info/METADATA,sha256=ejAhI1NaskFv_-PGUwtreHx1NeFStOX-8t9XCpTv0N4,4957
+odoo_addon_l10n_ro_account_edi_ubl-16.0.1.50.0.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+odoo_addon_l10n_ro_account_edi_ubl-16.0.1.50.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo_addon_l10n_ro_account_edi_ubl-16.0.1.50.0.dist-info/RECORD,,
```

